<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2021-02-05 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Beigesoft - 
    Beigesoft™ software (libraries) for rapid development of cross-platform financial WEB-applications.</title>
    <style type="text/css" media="all">
      @import url("./css/bootstrap.min.css");
      @import url("./css/bootstrap-theme.min.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20210205" />
    <meta http-equiv="Content-Language" content="en" />
        
          <link rel="icon" href="images/favicon.png">
  </head>
  <body>
      <img class="logo-right" src="images/logo.png" alt="${project.organization.name} logo">
    <div class="page-header">
      <h1>Beigesoft™ Enterprise Information System Java code. <small>      
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2021-02-05</span>
                  &nbsp;| <span id="projectVersion">Version: 1.2-SNAPSHOT</span>
                      </div>
      </small></h1>
    </div>
    <div id="leftColumn" class="list-group">
              
                    
                                <h5>Project Documentation</h5>
                  
                                                                                                                                                                                                                                                                        <a href="project-info.html" class="list-group-item"><span class='glyphicon glyphicon-expand' aria-hidden='true'></span>  Project Information</a>
                                                                                                               <a href="project-reports.html" class="list-group-item"><span class='glyphicon glyphicon-expand' aria-hidden='true'></span>  Project Reports</a>
                   
                       <h5>Articles</h5>
                  
                                  <a href="eis-bobs-pizza.html" class="list-group-item">Beigesoft™ EIS, Bob's pizza example</a>
                                     <a href="eis-iv.html" class="list-group-item">Пример ведения коммерческого бухгалтерского учета в Беижсофт™ ИСП</a>
                                     <a href="blcexmplen.html" class="list-group-item">Beigesoft™ libraries for rapid development of cross-platform financial WEB-applications.</a>
                                     <a href="blcexmplru.html" class="list-group-item">Беижсофт™ библиотеки для быстрой разработки кроссс-платформенного финансового ПО с ВЕБ-интерфейсом</a>
                                     <a href="bslfsc.html" class="list-group-item">Beigesoft™ Linux From Source Code</a>
                                     <a href="bslfscru.html" class="list-group-item">Беижсофт™ Линукс из исходных кодов</a>
                                     <a href="bsplay.html" class="list-group-item">Beigesoft™ multimedia player</a>
                                     <a href="bs-ctsp-in-c.html" class="list-group-item">Type-safe programming complex high-level applications in C.</a>
                                     <a href="pdesign.html" class="list-group-item">Programming approaches.</a>
                                     <a href="data-protect.html" class="list-group-item">Data protection.</a>
             
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
          </div>
    <div id="bodyColumn">
        

  

    <div class="section">
<h2>Example of simple ordering (booking of items) application. Part 2, cloud WAR version.<a name="Example_of_simple_ordering_booking_of_items_application._Part_2_cloud_WAR_version."></a></h2>

    
<div class="section">
<div class="section">
<h4>Creating WAR Maven project.<a name="Creating_WAR_Maven_project."></a></h4>

    
<p>Create a project folder &quot;myappweb&quot;, then create this <b>pom.xml</b> in it:
</p>
<div>
<pre style="white-space: pre-wrap;">
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;org.myapp&lt;/groupId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;artifactId&gt;ordering-web&lt;/artifactId&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;

  &lt;name&gt;My ordering WEB-application.&lt;/name&gt;
  &lt;inceptionYear&gt;2019&lt;/inceptionYear&gt;

  &lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;java.version&gt;1.7&lt;/java.version&gt;
  &lt;/properties&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.myapp&lt;/groupId&gt;
      &lt;artifactId&gt;ordering&lt;/artifactId&gt;
      &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.beigesoft&lt;/groupId&gt;
      &lt;artifactId&gt;beige-web-jar&lt;/artifactId&gt;
      &lt;version&gt;1.0&lt;/version&gt;
      &lt;exclusions&gt;
        &lt;exclusion&gt;
          &lt;groupId&gt;org.beigesoft&lt;/groupId&gt;
          &lt;artifactId&gt;beige-blc&lt;/artifactId&gt;
        &lt;/exclusion&gt;
      &lt;/exclusions&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.taglibs&lt;/groupId&gt;
      &lt;artifactId&gt;taglibs-standard-spec&lt;/artifactId&gt;
      &lt;version&gt;1.2.5&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.taglibs&lt;/groupId&gt;
      &lt;artifactId&gt;taglibs-standard-impl&lt;/artifactId&gt;
      &lt;version&gt;1.2.5&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.beigesoft&lt;/groupId&gt;
      &lt;artifactId&gt;beige-web&lt;/artifactId&gt;
      &lt;version&gt;1.0&lt;/version&gt;
      &lt;type&gt;war&lt;/type&gt;
      &lt;scope&gt;runtime&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;

  &lt;build&gt;
    &lt;finalName&gt;${project.artifactId}&lt;/finalName&gt;
    &lt;resources&gt;
      &lt;!--Apache Tomcat7 loads jars ordered by name, so beige-blc.jar
      is loaded first. Placing ordered resources
      to the WEB-INF/classes folder resolves this problem:--&gt;
      &lt;resource&gt;
        &lt;directory&gt;..${file.separator}myapp${file.separator}src${file.separator}main${file.separator}resources&lt;/directory&gt;
      &lt;/resource&gt;
    &lt;/resources&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-install-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.5.2&lt;/version&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.8.2&lt;/version&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.7&lt;/version&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.22.1&lt;/version&gt;
        &lt;configuration&gt;
          &lt;useSystemClassLoader&gt;false&lt;/useSystemClassLoader&gt;
          &lt;useFile&gt;false&lt;/useFile&gt;
          &lt;trimStackTrace&gt;false&lt;/trimStackTrace&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.1&lt;/version&gt;
        &lt;configuration&gt;
          &lt;source&gt;${java.version}&lt;/source&gt;
          &lt;target&gt;${java.version}&lt;/target&gt;
          &lt;compilerArgs&gt;
            &lt;arg&gt;-Xlint:all,-options,-path&lt;/arg&gt;
          &lt;/compilerArgs&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.1.0&lt;/version&gt;
        &lt;configuration&gt;
          &lt;overlays&gt;
            &lt;overlay /&gt;
            &lt;overlay&gt;
              &lt;groupId&gt;org.beigesoft&lt;/groupId&gt;
              &lt;artifactId&gt;beige-web&lt;/artifactId&gt;
              &lt;excludes&gt;
                &lt;exclude&gt;META-INF${file.separator}BEIGESOF.RSA&lt;/exclude&gt;
                &lt;exclude&gt;META-INF${file.separator}BEIGESOF.SF&lt;/exclude&gt;
              &lt;/excludes&gt;
            &lt;/overlay&gt;
          &lt;/overlays&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
  
&lt;/project&gt;
</pre></div>

<p>
  * This is the WAR archive of this JEE WEB application. Both WAR and JAR files are actually ZIP archives.
</p>
Then create these folders for the source code:

<div>
<pre style="white-space: pre-wrap;">
 myappweb - src - main - java - org - myapp - ordering
 myappweb - src - main - webapp - WEB-INF - jsp
 myappweb - src - main - webapp - META-INF
</pre></div>

    </div>
<div class="section">
<h4>Adding the models into the menu.<a name="Adding_the_models_into_the_menu."></a></h4>
    
<p>Copy the <b>dsk.jsp</b> from <b>beige-web</b> project into &quot;myappweb - src - main - webapp - WEB-INF - jsp&quot;, then add this drop-down menu with entities:
</p>
<div>
<pre style="white-space: pre-wrap;">
...
&lt;div class=&quot;navbar&quot;&gt;
  &lt;div class=&quot;dropdown&quot;&gt;
    &lt;a href=&quot;#&quot; class=&quot;dropdown-btn&quot;&gt;${i18n.getMsg(&quot;Ordering&quot;, rvs.upf.lng.iid)}&lt;/a&gt;
    &lt;div class=&quot;dropdown-content&quot;&gt;
      &lt;a href=&quot;#&quot; onclick=&quot;bsGtAjx('GET', 'srv?act=lst&amp;rnd=lhj&amp;ent=Customer&amp;pg=1');&quot;&gt;${i18n.getMsg(&quot;Customers&quot;, rvs.upf.lng.iid)}&lt;/a&gt;
      &lt;a href=&quot;#&quot; onclick=&quot;bsGtAjx('GET', 'srv?act=lst&amp;rnd=lhj&amp;ent=Merchandise&amp;pg=1');&quot;&gt;${i18n.getMsg(&quot;Merchandises&quot;, rvs.upf.lng.iid)}&lt;/a&gt;
      &lt;a href=&quot;#&quot; onclick=&quot;bsGtAjx('GET', 'srv?act=lst&amp;rnd=lhj&amp;ent=COrder&amp;pg=1');&quot;&gt;${i18n.getMsg(&quot;Orders&quot;, rvs.upf.lng.iid)}&lt;/a&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class=&quot;dropdown&quot;&gt;
...
</pre></div>
Then make the mbl.jsp in the same way.
    

    </div>
<div class="section">
<h4>web.xml<a name="web.xml"></a></h4>
    
<p>Copy the <b>web-sqlite.xml</b> from the <b>beige-web</b> project into the &quot;myappweb - src - main - webapp - WEB-INF&quot;, then rename it into &quot;web.xml&quot; and change application factory class:
</p>
<div>
<pre style="white-space: pre-wrap;">
...
&lt;context-param&gt;
  &lt;param-name&gt;fctAppCls&lt;/param-name&gt;
  &lt;param-value&gt;org.myapp.ordering.FctAppSqlt&lt;/param-value&gt;
&lt;/context-param&gt;
...
</pre></div>
A <b>web.xml</b> is the main file that describes about the JEE WEB-application.
    

    </div>
<div class="section">
<h4>Creating application factory for WAR version.<a name="Creating_application_factory_for_WAR_version."></a></h4>
    
<p>An application factory creates the all application's services (including inner factories) in the &quot;lazy mode&quot;. For example, a service that prints a PDF report will be created when an user pushes a &quot;Print order PDF&quot; button.
      Of course, factories for different platforms (OS) are different.
      At this time just copy the file org.beigesoft.war.FctAppSqlt.java from the <b>beige-web</b> into the &quot;myappweb - src - main - java - org - myapp - ordering&quot;,
      then change its package.
    </p>

    </div>
<div class="section">
<h4>JEE JDBC authentication.<a name="JEE_JDBC_authentication."></a></h4>
    
<p><b><i>* Browsers can refuse the JEE cookie &quot;JSESSIONID&quot; when it's used unencrypted HTTP connection (Chrome does this), and you will face &quot;HTTP Status 408 &#x2013; Request Timeout on http://localhost:8080/ordering-web/sec/j_security_check&quot;!
      So, you must either make HTTPS, or switch off JEE authentication in the &quot;web.xml&quot;! Any authentication is completely useless without an encrypted connection.</i></b></p>
    
<p>For Tomcat's standard, copy the <b>context-sqlt.xml</b> from the <b>beige-web</b> into the &quot;myappweb - src - main - webapp - META-INF&quot; rename it into &quot;context.xml&quot;, then change the database URL in it:
</p>
<div>
<pre style="white-space: pre-wrap;">
...
connectionURL=&quot;jdbc:sqlite:../webapps/ordering-web/myordering.sqlite&quot;
...
</pre></div>
    
    

    </div>
<div class="section">
<h4>The first start.<a name="The_first_start."></a></h4>
    
<p>Compile both projects by executing &quot;mvn clean install&quot; at the root folder of each project (where pom.xml is), first, at the <b>myapp</b>, then at the <b>myappweb</b>. The generated libraries <b>ordering.jar</b> and <b>ordering-web.war</b> will be in the target folders.
    To start Tomcat run in its &quot;bin&quot; folder &quot;startup.bat&quot; on MS Windows, or &quot;startup.sh&quot; on Unix-like OS.
    Copy the ordering-web.war file into Tomcat's &quot;webapps&quot; folder. The application will be deployed, it creates and fills SQLite database &quot;ordering-web/myordering.sqlite&quot; 
    </p>

<p>You should have installed H2 database as described in the 3-d article. Just run its SQL tool &quot;H2 console&quot;: in its &quot;bin&quot; folder run &quot;h2.bat&quot; on MS Windows or &quot;sh h2.sh&quot; on Unix like OS. The browser will open the WEB-interface of this tool,
select &quot;Saved Settings&quot;-&quot;Generic SQLite&quot; and type the database address in the &quot;JDBC URL&quot; field, e.g. &quot;jdbc:sqlite:C:\programmer\java\apache-tomcat-7.0.96\webapps\ordering-web\myordering.sqlite&quot;, do not care about user and password:
</p>

<p align="center"><img src="images/h2setren.png" style="max-width: 100%" alt="" /></p>

<p>
then push &quot;connect&quot;, H2 SQL console will show the tables, to insert users, just copy these entries and paste into the tool window, then push &quot;Run&quot;:
</p>

<div>
<pre style="white-space: pre-wrap;">
insert into USTMC (USR, PWD, VER) values ('admin', 'admin', 1);
insert into USTMC (USR, PWD, VER) values ('user', 'user', 1);
insert into USRLTMC (USR, ROL, VER)  values ('admin', 'admin', 1);
insert into USRLTMC (USR, ROL, VER)  values ('user', 'user', 1);
</pre></div>


<p>* See at the bottom of the <b>web.xml</b>, there is the JEE authentication part about roles and secure paths.</p>

<p>
After that you are able to login into &quot;secure place&quot; and make orders (user/password admin/admin), type in your browser &quot;http://localhost:8080/ordering-web&quot;:
</p>

<p align="center"><img src="images/editcord.png" style="max-width: 100%" alt="" /></p>

<p>Lists, edit forms, entity pickers will be generated automatically.</p>

<p><b><i>* Here the browser allowed the &quot;JSESSIONID&quot; cookie for unencrypted HTTP connection. See <a href="eis-import-db-web.html">Import an EIS database by using WEB-service</a></i>, how to make HTTPS!</b></p>
    </div>
<div class="section">
<h4>Internationalization<a name="Internationalization"></a></h4>
    
<p>For internationalization use ${i18n.getMsg(&quot;COrder&quot;, rvs.upf.lng.iid)} in a JSP page.
    You should add this message into <b>Msgs_en_US.properties</b> and non English e.g. <b>Msgs_ru_RU-UTF8.properties</b>.
    Just copy these files from <b>beige-blc/src/main/resources</b> and edit them. After editing make ASCII encoded file for non-English messages, e.g.:
</p>
<div>
<pre style="white-space: pre-wrap;">
native2ascii -encoding UTF-8 Msgs_ru_RU-UTF8.properties Msgs_ru_RU.properties
</pre></div>
Do not neglect Internationalization. Even some big WEB-stores have no advanced internationalization similar to Beigesoft WEB-store's one.
    

    </div>
<div class="section">
<h4>Conclusion<a name="Conclusion"></a></h4>
    
<p>This is the simplest example. As a result you have to enter Amount=Quantity*Price by hand. In the following articles we will customize this application to do all things automatically.</p>

    </div></div></div>

  


    </div>
    <div class="clear">
    </div>
    <hr/>
    <div class="footer">
              Copyright &#169;                   2019&#x2013;2021.
           All rights reserved.      
                    
                </div>
  </body>
</html>
